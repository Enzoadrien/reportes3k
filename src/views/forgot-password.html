<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Recuperar Contraseña</title>
<link rel="stylesheet" href="/css/globals.css">
<script src="/js/forgot.js" defer></script>
</head>
<body>
<main>
    <form id="forgotForm">
    <h2>Recuperar Contraseña</h2>
    <p>Introduce tu correo para enviarte un enlace de recuperación.</p>

    <label for="correo">Correo electrónico</label>
    <input type="email" id="correo" required>

    <button type="submit">Enviar enlace</button>
    <p id="msg"></p>
    </form>
</main>

<script defer>
    const form = document.getElementById("forgotForm");
    const msg = document.getElementById("msg");

    form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const correo = document.getElementById("correo").value;
    msg.style.color = "";
    msg.textContent = "Enviando correo...";

    try {
        const res = await fetch("/api/password/forgot", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ correo }),
        });

        const data = await res.json();
        msg.style.color = data.ok ? "green" : "red";
        msg.textContent = data.message || "Error al enviar el correo.";
    } catch {
        msg.style.color = "red";
        msg.textContent = "❌ Error del servidor.";
    }
    });
</script>
</body>
</html>
